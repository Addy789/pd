<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Pedalboard.js by dashersw - Open-source JavaScript framework for developing audio effects for guitars</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="javascripts/respond.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!--[if lt IE 8]>
    <link rel="stylesheet" href="stylesheets/ie.css">
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  </head>
  <body>
      <div id="header">
        <nav>
          <li class="fork"><a href="https://github.com/dashersw/pedalboard.js">View On GitHub</a></li>
          <li class="downloads"><a href="https://github.com/dashersw/pedalboard.js/zipball/master">ZIP</a></li>
          <li class="downloads"><a href="https://github.com/dashersw/pedalboard.js/tarball/master">TAR</a></li>
          <li class="title">DOWNLOADS</li>
        </nav>
      </div><!-- end header -->

    <div class="wrapper">

      <section>
        <div id="title">
          <h1>Pedalboard.js</h1>
          <p>Open-source JavaScript framework for developing audio effects for guitars</p>
          <h2 style="text-align: center;">Check out the <a href="http://dashersw.github.com/pedalboard.js/demo">demo</a>.<br/>Works best with the latest Chrome, and Safari is also OK. Enjoy the real-time line-in support but keep in mind that Chrome on Mac supports only the default input source (and it should be stereo).</h2>
          <hr>
          <span class="credits left">Project maintained by <a href="https://github.com/dashersw">dashersw</a></span>
          <span class="credits right">Hosted on GitHub Pages &mdash; Theme by <a href="http://twitter.com/#!/michigangraham">mattgraham</a></span>
        </div>

        <h1>Pedalboard.js</h1>

<hr><h2>Introduction</h2>

<p>Ever wanted to have your pedal stack in the cloud, available anywhere you go without any hardware? Ever wanted to manage your sound as easily as browsing a web site? Ever wanted to share the perfect sound you created with your friends without the hassle? You loved the overdrive on that effects software but wanted to tweak its EQ a little bit?</p>

<p>Pedalboard.js is a ground-breaking, first of its kind, novel open source JavaScript framework for developing audio effects and applying them to sound sources, and it's particularly good at guitar effects.</p>

<p>The API and all the abstraction is built around the concept of guitar effects — pedals and stomp boxes, pots and switches.</p>

<p>You design your pedal with the powerful WebKit audio API, attach pots and switches to it, style it via CSS3 and voila.</p>

<p>Bring multiple pedals together to create a pedalboard, easily adjust their settings and routing. Prepare as many pedalboards as you'd like, e.g. for your favorite styles. Easily switch pedalboards for a completely different sound.</p>

<p>Finally, a complete guitar effects stack, completely customizable, in your hands.</p>

<h3>Motivation</h3>

<p>Guitar effects software on the market are very nice indeed, but they somehow lack few important concepts — ease of use, portability, sharing stuff, customization, extensibility, etc.</p>

<p>What's worse, now that the freemium model is very popular, what looks like an easy initial buy turns into a small fortune when you'd like to buy the effects you wanted.</p>

<p>Pedalboard.js is an attempt to address these issues. With the help of the powerful audio API in WebKit, Pedalboard.js gives you a fairly-easy-to-build-upon abstraction and foundation.</p>

<hr><h1>Technology</h1>

<h2>Audio</h2>

<p>The technology that made Pedalboard.js available is WebKit's implementation of the W3C audio API. Although in its final draft version (which means it's more or less stable — at least in concept and context, but subject to change) the API is quite extensive, easy to use, extendable and has very nice approaches.</p>

<p>Right now, the audio API is only available in the latest WebKit-based browsers — Chrome and Safari. Mozilla is said to support it, with IE to follow suit.</p>

<h3>Nodes</h3>

<p>Audio API has the "node" concept at its core. Everything is a node and each node can connect to other nodes. A node can be a <em>source</em> (<em>array</em> or stream or generated by an <em>oscillator</em> or even arbitrary JS functions) or an <em>effect</em> or an <em>output</em>; or yet again, an <em>analyzer</em> to poke at what's going on inside.</p>

<p>Effects are the most versatile offering of the API. You can create <em>gain</em>, <em>wave shaping</em>, <em>convolution</em> or <em>filter</em> effects, all of which have various settings you can tweak. With this much opportunities, it's quite easy to build the perfect tone you're after.</p>

<h3>State of the art</h3>

<p>Currently, the AudioContext implementation in WebKit supports streaming audio from the inputs of your computer—line-in or microphone in Chrome and Safari, and soon will be a part of Firefox. In this context, the native implementation supports pre-recorded or generated sound buffers, as well as real-time input. This enables Pedalboard.js to fully function as a guitar effects stack. Experimentally, Pedalboard.js implements streaming from your input through a Flash proxy, too; but that's deprecated as of now, since the native version is already on the stage. Due to the hard-coded buffer size of 2048 samples in Flash, there's a latency of about 50ms, an audible delay. Unfortunately, there are no other workarounds to increase Flash stream quality; but as the native implementation has already rolled out, you can expect 0-latency input.</p>

<h2>JavaScript</h2>

<p>At its core, Pedalboard.js uses tartJS, an open source JavaScript framework developed at Tart New Media. tartJS is a library built upon Google Closure Library, which is another great library developed  by Google, Inc. Besides a great approach to object oriented programming and a vast amount of classes, Closure has a set of build tools that perfectly analyzes (read: lints) your code, and compiles and builds it.</p>

<p>Closure Library allows modular, object oriented JavaScript at its best, with tons of utility classes for DOM manipulation, visual effects, components, mathematics, arrays, objects, etc.</p>

<p>Closure Compiler not only minifies your code, but obfuscates it maximally, rewrites it to the letter to squeeze out the last bit of performance and file size. An entire web application can be under 30kb gzipped, which is quite insane.</p>

<hr><h1>Concepts</h1>

<p>Pedalboard.js follows an object oriented coding style, with an analogy to the real world objects and concepts.</p>

<p>Classes are modeled after real components of pedals and pedal boards. You configure each component as you configure a real pedal stack.</p>

<p>You use your pedal board on stage, connect your guitar to it, and connect it to an output, like an amp or a mixer. Pedalboard.js follows the same basic ideas.</p>

<h2>Stage</h2>

<p>At the base is the Stage. Stage is where everything lives — what you see, the floor, the place that hosts your pedal board. The Stage has one input, an instance of an Input class — FileInput (for pre-recorded sounds) or StreamInput (for line-in). It also has one output, an instance of an Output class, which is your speakers. Stage also hosts a pedal board, an instance of a Board class. Of course, you can swap the board currently on stage with another one. Stage also has its own AudioContext instance and everything inside the Stage shares this context.</p>

<p>Stage is a manager class, in classical terminology.</p>

<p>Usage:</p>

<div class="highlight"><pre><span class="kd">var</span> <span class="nx">stage</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">pb</span><span class="p">.</span><span class="nx">Stage</span><span class="p">();</span>
</pre></div>

<h2>Board</h2>

<p>Board is analogous to a pedal board, where you put and organize your pedals. It has an InputBuffer instance, an OutputBuffer instance and as many Pedal instances as you'd like. A Stage can hold only one Board at a single given time, but you can have many Boards and can swap them at your leisure. A stage connects its Input to the InputBuffer of the Board and its Output to the OutputBuffer of the Board.</p>

<p>Usage:</p>

<div class="highlight"><pre><span class="kd">var</span> <span class="nx">stage</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">pb</span><span class="p">.</span><span class="nx">Stage</span><span class="p">();</span>
<span class="kd">var</span> <span class="nx">board1</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">pb</span><span class="p">.</span><span class="nx">Board</span><span class="p">(</span><span class="nx">stage</span><span class="p">.</span><span class="nx">getContext</span><span class="p">());</span>
<span class="kd">var</span> <span class="nx">board2</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">pb</span><span class="p">.</span><span class="nx">Board</span><span class="p">(</span><span class="nx">stage</span><span class="p">.</span><span class="nx">getContext</span><span class="p">());</span>

<span class="nx">stage</span><span class="p">.</span><span class="nx">setBoard</span><span class="p">(</span><span class="nx">board1</span><span class="p">);</span>
<span class="nx">stage</span><span class="p">.</span><span class="nx">setBoard</span><span class="p">(</span><span class="nx">board2</span><span class="p">);</span>
</pre></div>

<h2>Pedal</h2>

<p>Pedal component is where the magic happens. Given an AudioContext, Pedal implements its effects in an effects chain. Pedal instances also have an InputBuffer and an OutputBuffer for brevity. The effects lie in between these two, so when two pedals are cascaded, the output buffer of the first will be connected to the input buffer of the latter. This lets a pedal provide a clean and expectable interface to the outer world — the other pedals or the pedal board.</p>

<p>One should be able to tweak a pedals parameters easily, and may want to turn it off at some point.</p>

<p>Pedalboard.js offers two abstractions for this; Pot and Switch.</p>

<p>Usage:</p>

<div class="highlight"><pre><span class="c1">// initialize the stage and get the context</span>
<span class="kd">var</span> <span class="nx">stage</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">pb</span><span class="p">.</span><span class="nx">Stage</span><span class="p">();</span>
<span class="kd">var</span> <span class="nx">ctx</span> <span class="o">=</span> <span class="nx">stage</span><span class="p">.</span><span class="nx">getContext</span><span class="p">();</span>

<span class="c1">// initialize the board and pedals</span>
<span class="kd">var</span> <span class="nx">board</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">pb</span><span class="p">.</span><span class="nx">Board</span><span class="p">(</span><span class="nx">ctx</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">od</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">pb</span><span class="p">.</span><span class="nx">stomp</span><span class="p">.</span><span class="nx">Overdrive</span><span class="p">(</span><span class="nx">ctx</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">reverb</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">pb</span><span class="p">.</span><span class="nx">stomp</span><span class="p">.</span><span class="nx">Reverb</span><span class="p">(</span><span class="nx">ctx</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">vol</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">pb</span><span class="p">.</span><span class="nx">stomp</span><span class="p">.</span><span class="nx">Volume</span><span class="p">(</span><span class="nx">ctx</span><span class="p">);</span>

<span class="c1">// add pedals to board</span>
<span class="nx">board</span><span class="p">.</span><span class="nx">addPedals</span><span class="p">([</span><span class="nx">od</span><span class="p">,</span> <span class="nx">reverb</span><span class="p">]);</span>
<span class="nx">board</span><span class="p">.</span><span class="nx">addPedalsAt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nx">vol</span><span class="p">);</span>

<span class="c1">// tweak pedal settings</span>
<span class="nx">od</span><span class="p">.</span><span class="nx">setDrive</span><span class="p">(</span><span class="mi">7</span><span class="p">);</span>
<span class="nx">od</span><span class="p">.</span><span class="nx">setLevel</span><span class="p">(</span><span class="mi">7</span><span class="p">);</span>
<span class="nx">reverb</span><span class="p">.</span><span class="nx">setLevel</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
<span class="nx">vol</span><span class="p">.</span><span class="nx">setLevel</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>

<span class="c1">// set the board on stage and start playing!</span>
<span class="nx">stage</span><span class="p">.</span><span class="nx">setBoard</span><span class="p">(</span><span class="nx">board</span><span class="p">);</span>
</pre></div>

<h2>Pot</h2>

<p>Pot component serves as a means to tweak a Pedal's parameters, such as gain, level, distortion, delay feedback, etc. It's analogous to a potentiometer, i.e. variable resistor.</p>

<p>LinearPot and LogPot are two classes that inherit from the Pot class, and provide two different potentiometer implementations. A pot has a value, and a multiplier. Value reflects a pedal's parameter value, such as gain. Multiplier is kind of like the resistance of a resistor. </p>

<p>One never accesses the value directly but through the getter method getValue. The Pot's setValue method requires a windowed range between 0 and 10, representing pot rotation. Values larger than 10 will be interpreted as 10 and lower than 0 will be interpreted as 0.</p>

<p>In an application where your parameter is required to be between 0 and 1, multiplier should be 0.1. When you need your parameter to have a range between 0 and 1000, your multiplier should be 100.</p>

<p>The only difference between a LinearPot and a LogPot is their algorithm of sweeping through their values. While LinearPot will just reflect setValue input times the multiplier, LogPot will calculate as log(setValue input) times 10 times multiplier.</p>

<p>Usage:</p>

<div class="highlight"><pre><span class="nx">pb</span><span class="p">.</span><span class="nx">stomp</span><span class="p">.</span><span class="nx">Overdrive</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">createPots</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">handler</span> <span class="o">=</span> <span class="nx">goog</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">setDrive</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">);</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">volumePot</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">pb</span><span class="p">.</span><span class="nx">pot</span><span class="p">.</span><span class="nx">Linear</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">gain</span><span class="p">.</span><span class="nx">gain</span><span class="p">,</span> <span class="s1">'volume'</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">);</span> <span class="c1">// this will automatically set the gain on change.</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">drivePot</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">pb</span><span class="p">.</span><span class="nx">pot</span><span class="p">.</span><span class="nx">Log</span><span class="p">(</span><span class="nx">handler</span><span class="p">,</span> <span class="s1">'drive'</span><span class="p">,</span> <span class="mi">200</span><span class="p">);</span> <span class="c1">// called with a function as the argument, this will call that function with its new value.</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">pots</span> <span class="o">=</span> <span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">drivePot</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">volumePot</span><span class="p">];</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">drivePot</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'valueChanged'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">setDrive</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">newValue</span><span class="p">);</span> <span class="c1">// we can explicitly listen to the change event and do things after a change.</span>
    <span class="p">},</span> <span class="k">this</span><span class="p">);</span>
<span class="p">};</span>

<span class="c1">// Later on, you can manually set a pot's value like</span>
<span class="nx">drivePot</span><span class="p">.</span><span class="nx">setValue</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
</pre></div>

<h2>Switch</h2>

<p>Switch class models a foot switch, used to toggle pedals or individual effects of pedals. A switch has an array of 3-node arrays and toggles between them when pressed. In Pedalboard.js, one defines any number of 3-node arrays and the connection will be handled by the switch.</p>

<p>The input should always be the middle node in a 3-node array. When <em>on</em>, a switch will connect the input to the first node. When <em>off</em>, a switch will connect the input to the last node. This is in fact modeled after a 3PDT switch, and functions the same.</p>

<p>Two classes, Toggle and Momentary, extend Switch and implement two different toggle mechanisms. Toggle is the standard switch, you press it once to turn it on, and it stays on until you press it again; it then turns off. Momentary is a little bit different, it's on as long as you press it and turns off as soon as you release it.</p>
      </section>

    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
      <script type="text/javascript">

          var _gaq = _gaq || [];
          _gaq.push(['_setAccount', 'UA-34850785-1']);
          _gaq.push(['_trackPageview']);

          (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
          })();

      </script>
  </body>
</html>
